<!DOCTYPE html>
<html>
  <title>CVEDatabase</title>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="css/dropdown.css" />
    <link rel="stylesheet" type="text/css" href="css/footer.css" />
    <link rel="stylesheet" type="text/css" href="css/table.css" />
    <link rel="stylesheet" type="text/css" href="css/topnav.css" />
    <link rel="stylesheet" type="text/css" href="css/home.css" />

    <div class="topnav">
      <a class="active" href="/">Home</a>
      <a href="/user/">Users</a>
      <a href="/CVE/">CVEs</a>
      <% if(username==false){ %>
        <div class="topnav-right">
          <a href="/login">Login</a>
          <a href="/register">Register</a>
        </div>
        <% }%>
        <%if(username){ %>
          <div class="topnav-right">
            <a href="/console/">Console</a>
            <div class="dropdown">
              <button class="dropbtn">Account</button>
              <div class="dropdown-content">
                <a href="/account/"><%=username %></a>
                <a href="/group/">Group</a>
              </div>
            </div>
          </div>
        <%}%>
      </div>
  </head>
  <body>
    <table id="table">
      <tr>
        <td>CVE Name</td>
        <td>CVE Title</td>
        <td>User</td>
        <td>Time</td>
        <td>ID</td>
      </tr>
  <%for(var i=0; i<cves.length; i++){%>
    <% var a = new Date(cves[i].TimeCreation);var year = a.getYear()-100; month = a.getMonth()+1;var date = a.getDate();var hour = a.getHours();var min = a.getMinutes() < 10 ? '0' + a.getMinutes() : a.getMinutes();var sec = a.getSeconds() < 10 ? '0' + a.getSeconds() : a.getSeconds(); var time = date + '/' + month + '/' + year + ' ' + hour + ':' + min + ':' + sec;%>
    <tr>
      <td><a href="<%=cves[i].CVEName%>"><%=cves[i].CVEName%></a></td>
      <td><%=cves[i].CVETitle%></td>
      <td><a href="../user/<%=cves[i].CVEUserCreate%>"><%=cves[i].CVEUserCreate%></a></td>
      <td><%=time%></td>
      <td><%=cves[i].id%></td>
    </tr>
  <%}%>
  </table>
  <form id="formrow" action="/CVE/" method="get">

  </form>
    <div class="footer">
      <h1>ciao</h1>
    </div>
  </body>
  <script type="text/javascript">
    const params = new URLSearchParams(window.location.search);
    var val = params.get('row');
    if (val && val>0) {
      var btn = document.createElement("button");
      btn.type = "submit";
      btn.name = "row";
      btn.value = parseInt(val)-20;
      btn.innerText = "<<"+(parseInt(val)-19).toString()+"-"+(parseInt(val)).toString();
      var form = document.getElementById('formrow');
      form.appendChild(btn);
      <%if(cves.length > 19){%>
        var btn = document.createElement("button");
        btn.type = "submit";
        btn.name = "row";
        btn.value = parseInt(val)-20;
        btn.innerText = (parseInt(val)+1).toString()+"-"+(parseInt(val)+20).toString()+">>";
        var form = document.getElementById('formrow');
        form.appendChild(btn);
      // document.getElementById("rowinput").setAttribute('value',parseInt(val)+20);
      // document.getElementById("rowinput").innerText = (parseInt(val)+1).toString()+"-"+(parseInt(val)+20).toString() + ">>";
      <%}%>
    }
    else {
      <%if(cves.length > 19){%>
        var btn = document.createElement("button");
        btn.type = "submit";
        btn.name = "row";
        btn.value = 20;
        btn.innerText = "20 >>";
        var form = document.getElementById('formrow');
        console.log(form);
        form.appendChild(btn);
      // document.getElementById("rowinput").setAttribute('value',20);
      // document.getElementById("rowinput").innerText = "20 >>";
      <%}%>
      var log = 2;
    }
  </script>
</html>
